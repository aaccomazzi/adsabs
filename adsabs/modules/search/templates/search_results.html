{% from "macros.html" import render_search_result, render_facet_box, render_pagination with context %} {# Local import #}
{% from "macros/search_macros.html" import render_search_form %} {# Global import #}

{% extends "layout.html" %}

{% block titlehead %}Search Results: {{ resp.get_query() }}{% endblock %}

{% block head%}{% endblock %}

{% block body %}

{{ render_search_form(form) }}

<div class="container">
	<div class="row">
		<div class="span pull-right">
			<button class="btn">More</button>
		</div>
		<div class="span pull-right">
			<button class="btn">Sort</button>
		</div>
		<div class="span pull-right results_count">
			Showing records {{ resp.get_start_count() + 1}} to {{ resp.get_start_count() + resp.get_count_in_resp() }} out of {{ resp.get_count() }} results.
		</div>
	</div>
	<div class="row">
		<div class="span2" id="facets">
			{{ render_facet_box('aut_f', 'Authors', resp, open=True) }}
			{{ render_facet_box('key_f', 'Keywords', resp) }}
			{{ render_facet_box('bib_f', 'Publications', resp) }}
			{{ render_facet_box('prop_f', 'Refereed status', resp, limit_to=['refereed', 'not refereed'], facetid_html='refereed_f') }}
		</div>
		<div class="span10" id="results">
			<form action="/search/dispatch">
				<div class="container-fluid">
				{% for doc in resp.get_docset_objects() %}
				    {{ render_search_result(doc, loop, resp.get_start_count()) }}
				{% endfor %}
				</div>
			</form>
			{{ render_pagination(resp.get_pagination()) }}
		</div>
	</div>
</div>

{% endblock %}